<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë™ì•„ë¦¬ ê´€ë¦¬ í”Œë«í¼ ì¬ë¬´ ì‹œë®¬ë ˆì´ì…˜</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/2.1.0/chartjs-plugin-annotation.min.js"></script>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f7fa;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 30px;
      }
      h1 {
        color: #2c3e50;
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.2em;
      }
      h2 {
        color: #34495e;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
        margin-top: 40px;
      }
      .chart-container {
        position: relative;
        height: 400px;
        margin: 20px 0;
        background: #fff;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }
      .summary-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }
      .metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }
      .metric-card {
        background: #ecf0f1;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
      }
      .metric-value {
        font-size: 1.8em;
        font-weight: bold;
        color: #2c3e50;
      }
      .metric-label {
        color: #7f8c8d;
        margin-top: 5px;
      }
      .positive {
        color: #27ae60;
      }
      .negative {
        color: #e74c3c;
      }
      .warning {
        color: #f39c12;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }
      th,
      td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      th {
        background-color: #3498db;
        color: white;
      }
      tr:nth-child(even) {
        background-color: #f2f2f2;
      }

      /* ë°˜ì‘í˜• ë””ìì¸ */
      @media (max-width: 768px) {
        .grid {
          grid-template-columns: 1fr;
        }
        .metrics {
          grid-template-columns: 1fr;
        }
        h1 {
          font-size: 1.5em;
        }
      }

      /* ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ ë²„íŠ¼ */
      .scenario-buttons {
        display: flex;
        gap: 10px;
        margin: 20px 0;
        flex-wrap: wrap;
      }
      .scenario-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        background: #3498db;
        color: white;
        cursor: pointer;
        font-size: 1em;
        transition: all 0.3s;
      }
      .scenario-btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
      }
      .scenario-btn.active {
        background: #27ae60;
      }

      /* ë°ì´í„° í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
      .data-table-container {
        max-height: 400px;
        overflow-y: auto;
        margin: 20px 0;
      }

      /* ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ */
      .export-buttons {
        display: flex;
        gap: 10px;
        margin: 20px 0;
      }
      .export-btn {
        padding: 10px 20px;
        border: 2px solid #3498db;
        border-radius: 5px;
        background: white;
        color: #3498db;
        cursor: pointer;
        font-size: 1em;
        transition: all 0.3s;
      }
      .export-btn:hover {
        background: #3498db;
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ì˜¬ì¸ì› ë™ì•„ë¦¬ ê´€ë¦¬ í”Œë«í¼ ì¬ë¬´ ì‹œë®¬ë ˆì´ì…˜</h1>

      <h2>ğŸ“Œ ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ</h2>
      <div class="scenario-buttons">
        <button class="scenario-btn" onclick="changeScenario('conservative')">
          ë³´ìˆ˜ì  ì‹œë‚˜ë¦¬ì˜¤
        </button>
        <button class="scenario-btn active" onclick="changeScenario('base')">
          ê¸°ë³¸ ì‹œë‚˜ë¦¬ì˜¤
        </button>
        <button class="scenario-btn" onclick="changeScenario('optimistic')">
          ë‚™ê´€ì  ì‹œë‚˜ë¦¬ì˜¤
        </button>
      </div>

      <div class="export-buttons">
        <button class="export-btn" onclick="exportToCSV()">
          ğŸ“¥ CSV ë‹¤ìš´ë¡œë“œ
        </button>
        <button class="export-btn" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
      </div>

      <div class="summary-box">
        <h2 style="color: white; border: none; margin-top: 0">
          í•µì‹¬ ì¬ë¬´ ì§€í‘œ
        </h2>
        <div class="metrics">
          <div class="metric-card">
            <div class="metric-value">â‚©1,064,000</div>
            <div class="metric-label">ì´ˆê¸° íˆ¬ìê¸ˆ</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">â‚©2,218,000</div>
            <div class="metric-label">ì›”ê°„ ìš´ì˜ë¹„</div>
          </div>
          <div class="metric-card">
            <div class="metric-value">15ê°œì›”</div>
            <div class="metric-label">ì˜ˆìƒ ì†ìµë¶„ê¸°ì </div>
          </div>
          <div class="metric-card">
            <div class="metric-value">â‚©75,000,000</div>
            <div class="metric-label">3ë…„ì°¨ ì—°ê°„ ëª©í‘œ ìˆ˜ìµ</div>
          </div>
        </div>
      </div>

      <h2>ğŸ“Š ì›”ë³„ ìˆ˜ìµ êµ¬ì„±</h2>
      <div class="chart-container">
        <canvas id="revenueChart"></canvas>
      </div>

      <div class="grid">
        <div>
          <h2>ğŸ’° ìˆ˜ìµ vs ì§€ì¶œ</h2>
          <div class="chart-container">
            <canvas id="profitChart"></canvas>
          </div>
        </div>
        <div>
          <h2>ğŸ“ˆ ëˆ„ì  í˜„ê¸ˆ íë¦„</h2>
          <div class="chart-container">
            <canvas id="cashFlowChart"></canvas>
          </div>
        </div>
      </div>

      <div class="grid">
        <div>
          <h2>ğŸ‘¥ ì‚¬ìš©ì ì¦ê°€</h2>
          <div class="chart-container">
            <canvas id="usersChart"></canvas>
          </div>
        </div>
        <div>
          <h2>ğŸ” ë¹„ìš© êµ¬ì„±</h2>
          <div class="chart-container">
            <canvas id="costBreakdownChart"></canvas>
          </div>
        </div>
      </div>

      <h2>ğŸ“‹ ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¶„ì„</h2>
      <table>
        <thead>
          <tr>
            <th>ì‹œë‚˜ë¦¬ì˜¤</th>
            <th>3ë…„ í›„ ëˆ„ì  í˜„ê¸ˆ</th>
            <th>ì†ìµë¶„ê¸°ì </th>
            <th>ì—°ê°„ ìˆ˜ìµ (3ë…„ì°¨)</th>
            <th>ìœ„í—˜ë„</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ë³´ìˆ˜ì </td>
            <td class="negative">â‚©-15,000,000</td>
            <td>ë¯¸ë‹¬ì„±</td>
            <td>â‚©52,500,000</td>
            <td class="negative">ë†’ìŒ</td>
          </tr>
          <tr>
            <td>ê¸°ë³¸</td>
            <td class="positive">â‚©25,000,000</td>
            <td>15ê°œì›”</td>
            <td>â‚©75,000,000</td>
            <td class="warning">ì¤‘ê°„</td>
          </tr>
          <tr>
            <td>ë‚™ê´€ì </td>
            <td class="positive">â‚©65,000,000</td>
            <td>12ê°œì›”</td>
            <td>â‚©90,000,000</td>
            <td class="positive">ë‚®ìŒ</td>
          </tr>
        </tbody>
      </table>

      <h2>âš ï¸ ë¦¬ìŠ¤í¬ ë¶„ì„ ë° ê¶Œì¥ì‚¬í•­</h2>
      <div
        style="
          background: #fff3cd;
          border: 1px solid #ffeaa7;
          border-radius: 8px;
          padding: 20px;
          margin: 20px 0;
        "
      >
        <h3 style="color: #856404; margin-top: 0">ì£¼ìš” ë¦¬ìŠ¤í¬</h3>
        <ul>
          <li>
            <strong>ì´ˆê¸° í˜„ê¸ˆ ë¶€ì¡±:</strong> ì²« 12ê°œì›”ê°„ ì•½ â‚©20,000,000ì˜ í˜„ê¸ˆ
            ë¶€ì¡± ì˜ˆìƒ
          </li>
          <li>
            <strong>ì‚¬ìš©ì í™•ë³´ ì§€ì—°:</strong> 1ë‹¨ê³„ ì‚¬ìš©ì ì¦ê°€ìœ¨ì´ ëª©í‘œì—
            ë¯¸ë‹¬í•  ê²½ìš°
          </li>
          <li>
            <strong>B2B/B2G ì „í™˜ ì‹¤íŒ¨:</strong> 2ë‹¨ê³„ ìˆ˜ìµ ëª¨ë¸ ì‹¤í˜„ì´ ì§€ì—°ë 
            ê²½ìš°
          </li>
        </ul>

        <h3 style="color: #856404">ê¶Œì¥ì‚¬í•­</h3>
        <ul>
          <li>
            <strong>ì´ˆê¸° ìë³¸:</strong> ìµœì†Œ â‚©35,000,000 í™•ë³´ (ì•ˆì „ ë§ˆì§„ í¬í•¨)
          </li>
          <li>
            <strong>ë§ˆì¼ìŠ¤í†¤ ê´€ë¦¬:</strong> 6ê°œì›”ë§ˆë‹¤ ì‚¬ìš©ì ì¦ê°€ìœ¨ ë° ìˆ˜ìµ ëª¨ë¸
            ì¬ê²€í† 
          </li>
          <li>
            <strong>ë¹„ìš© ìµœì í™”:</strong> ì´ˆê¸° ë§ˆì¼€íŒ… ë¹„ìš©ì„ ì„±ê³¼ ê¸°ë°˜ìœ¼ë¡œ ì¡°ì •
          </li>
          <li>
            <strong>íŒŒíŠ¸ë„ˆì‹­:</strong> ëŒ€í•™ ë° ê¸°ì—…ê³¼ì˜ ì¡°ê¸° íŒŒíŠ¸ë„ˆì‹­ êµ¬ì¶•
          </li>
        </ul>
      </div>

      <h2>ğŸ“Š ì›”ë³„ ìƒì„¸ ë°ì´í„°</h2>
      <div class="data-table-container">
        <table id="monthlyDataTable">
          <thead>
            <tr>
              <th>ì›”</th>
              <th>í™œì„± ì‚¬ìš©ì</th>
              <th>1ë‹¨ê³„ ìˆ˜ìµ</th>
              <th>B2B ìˆ˜ìµ</th>
              <th>B2G ìˆ˜ìµ</th>
              <th>ì´ ìˆ˜ìµ</th>
              <th>ì›”ê°„ ì§€ì¶œ</th>
              <th>ìˆœì´ìµ</th>
              <th>ëˆ„ì  í˜„ê¸ˆ</th>
            </tr>
          </thead>
          <tbody id="monthlyDataBody">
            <!-- JavaScriptë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
          </tbody>
        </table>
      </div>
    </div>

    <script>
      // í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤
      let currentScenario = "base";

      // ì›”ë³„ ë°ì´í„° ìƒì„±
      const months = Array.from({ length: 36 }, (_, i) => i + 1);

      // ìˆ˜ìµ ë°ì´í„° ê³„ì‚°
      function calculateRevenue(scenario = "base") {
        const data = {
          phase1: [],
          b2b: [],
          b2g: [],
          total: [],
          users: [],
          expenses: [],
          cumulative: [],
        };

        // ì‹œë‚˜ë¦¬ì˜¤ë³„ íŒŒë¼ë¯¸í„°
        const scenarioParams = {
          conservative: {
            userGrowth: 1.1,
            maxUsers: 3000,
            adRevenue: 2500,
            b2bMultiplier: 0.7,
            b2gMultiplier: 0.6,
          },
          base: {
            userGrowth: 1.15,
            maxUsers: 5000,
            adRevenue: 3000,
            b2bMultiplier: 1.0,
            b2gMultiplier: 1.0,
          },
          optimistic: {
            userGrowth: 1.2,
            maxUsers: 7000,
            adRevenue: 3500,
            b2bMultiplier: 1.2,
            b2gMultiplier: 1.15,
          },
        };

        const params = scenarioParams[scenario];
        let cumulativeCash = -1064000; // ì´ˆê¸° íˆ¬ì

        for (let month = 1; month <= 36; month++) {
          // 1ë‹¨ê³„ ê´‘ê³  ìˆ˜ìµ (1-12ì›”)
          let phase1Revenue = 0;
          let users = 0;
          if (month <= 12) {
            users = Math.min(
              100 * Math.pow(params.userGrowth, month - 1),
              params.maxUsers
            );
            phase1Revenue = users * params.adRevenue;
          } else {
            users = params.maxUsers * 1.2; // 2ë‹¨ê³„ì—ì„œ ì‚¬ìš©ì ìœ ì§€
          }

          // 2ë‹¨ê³„ ìˆ˜ìµ (13ì›”ë¶€í„°)
          let b2bRevenue = 0;
          let b2gRevenue = 0;
          if (month >= 13) {
            const monthsFrom13 = month - 13;
            b2bRevenue =
              (50000000 / 12) *
              params.b2bMultiplier *
              Math.pow(1.1, monthsFrom13 / 12);
            b2gRevenue =
              (25000000 / 12) *
              params.b2gMultiplier *
              Math.pow(1.08, monthsFrom13 / 12);
          }

          const totalRevenue = phase1Revenue + b2bRevenue + b2gRevenue;

          // ì§€ì¶œ ê³„ì‚°
          let monthlyExpense = 2218000;
          if (month > 6) {
            monthlyExpense *= 1 + 0.05 * Math.floor((month - 1) / 6);
          }

          cumulativeCash += totalRevenue - monthlyExpense;

          data.phase1.push(phase1Revenue / 1000000);
          data.b2b.push(b2bRevenue / 1000000);
          data.b2g.push(b2gRevenue / 1000000);
          data.total.push(totalRevenue / 1000000);
          data.users.push(Math.round(users));
          data.expenses.push(monthlyExpense / 1000000);
          data.cumulative.push(cumulativeCash / 1000000);
        }

        return data;
      }

      let revenueData = calculateRevenue();

      // ì°¨íŠ¸ ê°ì²´ ì €ì¥
      let revenueChart,
        profitChart,
        cashFlowChart,
        usersChart,
        costBreakdownChart;

      // ì°¨íŠ¸ 1: ì›”ë³„ ìˆ˜ìµ êµ¬ì„±
      revenueChart = new Chart(document.getElementById("revenueChart"), {
        type: "line",
        data: {
          labels: months,
          datasets: [
            {
              label: "1ë‹¨ê³„ ê´‘ê³  ìˆ˜ìµ",
              data: revenueData.phase1,
              borderColor: "#3498db",
              backgroundColor: "rgba(52, 152, 219, 0.1)",
              fill: false,
            },
            {
              label: "B2B ìˆ˜ìµ",
              data: revenueData.b2b,
              borderColor: "#2ecc71",
              backgroundColor: "rgba(46, 204, 113, 0.1)",
              fill: false,
            },
            {
              label: "B2G ìˆ˜ìµ",
              data: revenueData.b2g,
              borderColor: "#e74c3c",
              backgroundColor: "rgba(231, 76, 60, 0.1)",
              fill: false,
            },
            {
              label: "ì´ ìˆ˜ìµ",
              data: revenueData.total,
              borderColor: "#9b59b6",
              backgroundColor: "rgba(155, 89, 182, 0.1)",
              borderWidth: 3,
              fill: false,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: "ìˆ˜ìµ (ë°±ë§Œì›)",
              },
            },
            x: {
              title: {
                display: true,
                text: "ì›”",
              },
            },
          },
        },
      });

      // ì°¨íŠ¸ 2: ìˆ˜ìµ vs ì§€ì¶œ
      profitChart = new Chart(document.getElementById("profitChart"), {
        type: "line",
        data: {
          labels: months,
          datasets: [
            {
              label: "ì´ ìˆ˜ìµ",
              data: revenueData.total,
              borderColor: "#2ecc71",
              backgroundColor: "rgba(46, 204, 113, 0.2)",
              fill: false,
            },
            {
              label: "ì›”ê°„ ì§€ì¶œ",
              data: revenueData.expenses,
              borderColor: "#e74c3c",
              backgroundColor: "rgba(231, 76, 60, 0.2)",
              fill: false,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: "ê¸ˆì•¡ (ë°±ë§Œì›)",
              },
            },
          },
        },
      });

      // ì°¨íŠ¸ 3: ëˆ„ì  í˜„ê¸ˆ íë¦„
      cashFlowChart = new Chart(document.getElementById("cashFlowChart"), {
        type: "line",
        data: {
          labels: months,
          datasets: [
            {
              label: "ëˆ„ì  í˜„ê¸ˆ",
              data: revenueData.cumulative,
              borderColor: "#3498db",
              backgroundColor: function (context) {
                const value = context.parsed.y;
                return value >= 0
                  ? "rgba(46, 204, 113, 0.3)"
                  : "rgba(231, 76, 60, 0.3)";
              },
              fill: true,
              borderWidth: 2,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              title: {
                display: true,
                text: "ëˆ„ì  í˜„ê¸ˆ (ë°±ë§Œì›)",
              },
            },
          },
          plugins: {
            annotation: {
              annotations: {
                line1: {
                  type: "line",
                  yMin: 0,
                  yMax: 0,
                  borderColor: "red",
                  borderWidth: 2,
                  borderDash: [5, 5],
                },
              },
            },
          },
        },
      });

      // ì°¨íŠ¸ 4: ì‚¬ìš©ì ì¦ê°€
      usersChart = new Chart(document.getElementById("usersChart"), {
        type: "line",
        data: {
          labels: months,
          datasets: [
            {
              label: "í™œì„± ì‚¬ìš©ì ìˆ˜",
              data: revenueData.users,
              borderColor: "#f39c12",
              backgroundColor: "rgba(243, 156, 18, 0.2)",
              fill: true,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: "ì‚¬ìš©ì ìˆ˜",
              },
            },
          },
        },
      });

      // ì°¨íŠ¸ 5: ë¹„ìš© êµ¬ì„± (íŒŒì´ ì°¨íŠ¸)
      costBreakdownChart = new Chart(
        document.getElementById("costBreakdownChart"),
        {
          type: "doughnut",
          data: {
            labels: ["ì¸ê±´ë¹„", "ì„œë²„/í´ë¼ìš°ë“œ", "ë§ˆì¼€íŒ…", "SaaS", "ê¸°íƒ€"],
            datasets: [
              {
                data: [1500000, 230000, 350000, 80000, 58000],
                backgroundColor: [
                  "#3498db",
                  "#2ecc71",
                  "#e74c3c",
                  "#f39c12",
                  "#9b59b6",
                ],
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "bottom",
              },
            },
          },
        }
      );

      // ì›”ë³„ ë°ì´í„° í…Œì´ë¸” ì±„ìš°ê¸°
      function populateMonthlyDataTable() {
        const tbody = document.getElementById("monthlyDataBody");
        tbody.innerHTML = "";

        for (let i = 0; i < months.length; i++) {
          const row = tbody.insertRow();
          const month = months[i];
          const phase1 = (revenueData.phase1[i] * 1000000).toLocaleString(
            "ko-KR"
          );
          const b2b = (revenueData.b2b[i] * 1000000).toLocaleString("ko-KR");
          const b2g = (revenueData.b2g[i] * 1000000).toLocaleString("ko-KR");
          const total = (revenueData.total[i] * 1000000).toLocaleString(
            "ko-KR"
          );
          const expense = (revenueData.expenses[i] * 1000000).toLocaleString(
            "ko-KR"
          );
          const profit = (
            (revenueData.total[i] - revenueData.expenses[i]) *
            1000000
          ).toLocaleString("ko-KR");
          const cumulative = (
            revenueData.cumulative[i] * 1000000
          ).toLocaleString("ko-KR");
          const users = revenueData.users[i].toLocaleString("ko-KR");

          const profitValue =
            (revenueData.total[i] - revenueData.expenses[i]) * 1000000;
          const cumulativeValue = revenueData.cumulative[i] * 1000000;

          row.innerHTML = `
            <td>${month}</td>
            <td>${users}</td>
            <td>â‚©${phase1}</td>
            <td>â‚©${b2b}</td>
            <td>â‚©${b2g}</td>
            <td>â‚©${total}</td>
            <td>â‚©${expense}</td>
            <td class="${
              profitValue >= 0 ? "positive" : "negative"
            }">â‚©${profit}</td>
            <td class="${
              cumulativeValue >= 0 ? "positive" : "negative"
            }">â‚©${cumulative}</td>
          `;
        }
      }

      // í•µì‹¬ ì§€í‘œ ì—…ë°ì´íŠ¸
      function updateKeyMetrics() {
        const breakEvenMonth = revenueData.cumulative.findIndex((v) => v >= 0);
        const year3Revenue = ((revenueData.total[35] * 12) / 1000000).toFixed(
          0
        );
        const finalCash = (revenueData.cumulative[35] / 1000000).toFixed(1);

        const metricCards = document.querySelectorAll(".metric-value");
        metricCards[2].textContent =
          breakEvenMonth > 0 ? `${breakEvenMonth + 1}ê°œì›”` : "ë¯¸ë‹¬ì„±";
        metricCards[3].textContent = `â‚©${year3Revenue},000,000`;
      }

      // ì‹œë‚˜ë¦¬ì˜¤ ë³€ê²½
      function changeScenario(scenario) {
        currentScenario = scenario;

        // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
        document.querySelectorAll(".scenario-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        event.target.classList.add("active");

        // ë°ì´í„° ì¬ê³„ì‚°
        revenueData = calculateRevenue(scenario);

        // ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸
        // ì°¨íŠ¸ 1: ì›”ë³„ ìˆ˜ìµ êµ¬ì„±
        revenueChart.data.datasets[0].data = revenueData.phase1;
        revenueChart.data.datasets[1].data = revenueData.b2b;
        revenueChart.data.datasets[2].data = revenueData.b2g;
        revenueChart.data.datasets[3].data = revenueData.total;
        revenueChart.update();

        // ì°¨íŠ¸ 2: ìˆ˜ìµ vs ì§€ì¶œ
        profitChart.data.datasets[0].data = revenueData.total;
        profitChart.data.datasets[1].data = revenueData.expenses;
        profitChart.update();

        // ì°¨íŠ¸ 3: ëˆ„ì  í˜„ê¸ˆ íë¦„
        cashFlowChart.data.datasets[0].data = revenueData.cumulative;
        cashFlowChart.update();

        // ì°¨íŠ¸ 4: ì‚¬ìš©ì ì¦ê°€
        usersChart.data.datasets[0].data = revenueData.users;
        usersChart.update();

        // í…Œì´ë¸” ì—…ë°ì´íŠ¸
        populateMonthlyDataTable();

        // í•µì‹¬ ì§€í‘œ ì—…ë°ì´íŠ¸
        updateKeyMetrics();
      }

      // CSV ë‚´ë³´ë‚´ê¸°
      function exportToCSV() {
        let csv =
          "ì›”,í™œì„± ì‚¬ìš©ì,1ë‹¨ê³„ ìˆ˜ìµ,B2B ìˆ˜ìµ,B2G ìˆ˜ìµ,ì´ ìˆ˜ìµ,ì›”ê°„ ì§€ì¶œ,ìˆœì´ìµ,ëˆ„ì  í˜„ê¸ˆ\n";

        for (let i = 0; i < months.length; i++) {
          const month = months[i];
          const users = revenueData.users[i];
          const phase1 = (revenueData.phase1[i] * 1000000).toFixed(0);
          const b2b = (revenueData.b2b[i] * 1000000).toFixed(0);
          const b2g = (revenueData.b2g[i] * 1000000).toFixed(0);
          const total = (revenueData.total[i] * 1000000).toFixed(0);
          const expense = (revenueData.expenses[i] * 1000000).toFixed(0);
          const profit = (
            (revenueData.total[i] - revenueData.expenses[i]) *
            1000000
          ).toFixed(0);
          const cumulative = (revenueData.cumulative[i] * 1000000).toFixed(0);

          csv += `${month},${users},${phase1},${b2b},${b2g},${total},${expense},${profit},${cumulative}\n`;
        }

        const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);

        link.setAttribute("href", url);
        link.setAttribute(
          "download",
          `ì¬ë¬´ì‹œë®¬ë ˆì´ì…˜_${currentScenario}_${
            new Date().toISOString().split("T")[0]
          }.csv`
        );
        link.style.visibility = "hidden";

        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }

      // ì´ˆê¸°í™”
      populateMonthlyDataTable();
    </script>
  </body>
</html>
